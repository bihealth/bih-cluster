


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Public documentation of the BIH HPC infrastructure.">
      
      
        <link rel="canonical" href="https://bihealth.github.io/bih-cluster/first-steps/episode-3/">
      
      
        <meta name="author" content="BIH HPC IT">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.5">
    
    
      
        <title>Episode 3 - BIH HPC Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.df84b5fe.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#first-steps-episode-3" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://bihealth.github.io/bih-cluster" title="BIH HPC Docs" class="md-header-nav__button md-logo" aria-label="BIH HPC Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            BIH HPC Docs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Episode 3
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/bihealth/bih-cluster/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    BIH HPC Docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://bihealth.github.io/bih-cluster" title="BIH HPC Docs" class="md-nav__button md-logo" aria-label="BIH HPC Docs">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    BIH HPC Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/bihealth/bih-cluster/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    BIH HPC Docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Administrative
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Administrative" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Administrative
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/getting-access/" title="Getting Access" class="md-nav__link">
      Getting Access
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/resource-registration/" title="Resource Registration" class="md-nav__link">
      Resource Registration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/maintenance/" title="Maintenance etc." class="md-nav__link">
      Maintenance etc.
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../admin/provided-software/" title="Provided Software" class="md-nav__link">
      Provided Software
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting Help
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Getting Help" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Getting Help
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../help/helpdesk/" title="HPC Helpdesk" class="md-nav__link">
      HPC Helpdesk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../help/good-tickets/" title="Good Tickets" class="md-nav__link">
      Good Tickets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../help/faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Overview
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Overview" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/for-the-impatient/" title="For the Impatient" class="md-nav__link">
      For the Impatient
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/job-scheduler/" title="Job Scheduler" class="md-nav__link">
      Job Scheduler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/storage/" title="Nodes and Volumes" class="md-nav__link">
      Nodes and Volumes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Connecting
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Connecting" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Connecting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      Generate Keys
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Generate Keys" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Generate Keys
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/generate-key/linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/generate-key/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      Submit Keys
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Submit Keys" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Submit Keys
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/submit-key/charite/" title="Charite" class="md-nav__link">
      Charite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/submit-key/mdc/" title="MDC" class="md-nav__link">
      MDC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-3" type="checkbox" id="nav-5-3">
    
    <label class="md-nav__link" for="nav-5-3">
      Configure Client
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Configure Client" data-md-level="2">
      <label class="md-nav__title" for="nav-5-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Configure Client
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/configure-ssh/prerequisites/" title="Pre-Requisites" class="md-nav__link">
      Pre-Requisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/configure-ssh/linux/" title="Linux" class="md-nav__link">
      Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/configure-ssh/windows/" title="Windows" class="md-nav__link">
      Windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/configure-ssh/connection-problems/" title="Connection Problems" class="md-nav__link">
      Connection Problems
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/from-external/" title="From External" class="md-nav__link">
      From External
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../connecting/ssh-client-windows/" title="Windows SSH Client" class="md-nav__link">
      Windows SSH Client
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      First Steps
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="First Steps" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        First Steps
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../episode-0/" title="Episode 0" class="md-nav__link">
      Episode 0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../episode-1/" title="Episode 1" class="md-nav__link">
      Episode 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../episode-2/" title="Episode 2" class="md-nav__link">
      Episode 2
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="Episode 3" class="md-nav__link md-nav__link--active">
      Episode 3
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../episode-4/" title="Episode 4" class="md-nav__link">
      Episode 4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Storage
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Storage" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Storage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../storage/accessing-snapshots/" title="Accessing Snapshots" class="md-nav__link">
      Accessing Snapshots
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../storage/querying-storage/" title="Querying Quotas" class="md-nav__link">
      Querying Quotas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../storage/storage-locations/" title="Storage Locations" class="md-nav__link">
      Storage Locations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Slurm Scheduler
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Slurm Scheduler" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Slurm Scheduler
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/overview/" title="Slurm Overview" class="md-nav__link">
      Slurm Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/quickstart/" title="Slurm Quickstart" class="md-nav__link">
      Slurm Quickstart
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/cheat-sheet/" title="Slurm Cheat Sheet" class="md-nav__link">
      Slurm Cheat Sheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/migrating/" title="Migrating to Slurm" class="md-nav__link">
      Migrating to Slurm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/format-strings/" title="Format Strings" class="md-nav__link">
      Format Strings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/job-scripts/" title="Slurm Job Scripts" class="md-nav__link">
      Slurm Job Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/snakemake/" title="Snakemake with Slurm" class="md-nav__link">
      Snakemake with Slurm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/rosetta-stone/" title="Slurm Rosetta Stone" class="md-nav__link">
      Slurm Rosetta Stone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../slurm/x11/" title="X11 Forwarding" class="md-nav__link">
      X11 Forwarding
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Best Practice
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Best Practice" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Best Practice
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/project-structure/" title="Project Structure" class="md-nav__link">
      Project Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/software-craftmanship/" title="Software Craftmanship" class="md-nav__link">
      Software Craftmanship
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/screen-tmux/" title="Using Screen/Tmux" class="md-nav__link">
      Using Screen/Tmux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/bashrc-guide/" title="~/.bashrc Guide" class="md-nav__link">
      ~/.bashrc Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/temp-files/" title="Temporary Files" class="md-nav__link">
      Temporary Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/env-modules/" title="Custom Environment Modules" class="md-nav__link">
      Custom Environment Modules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../best-practice/software-installation-with-conda/" title="Install with Conda" class="md-nav__link">
      Install with Conda
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Static Data
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Static Data" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Static Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/annotations/" title="Annotations" class="md-nav__link">
      Annotations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/app-support/" title="Application Support" class="md-nav__link">
      Application Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/exomes-panels/" title="Exomes and Panels" class="md-nav__link">
      Exomes and Panels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/exon-lists/" title="Exon Lists" class="md-nav__link">
      Exon Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/index-files/" title="Precomputed Indexes" class="md-nav__link">
      Precomputed Indexes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cubit/references/" title="Reference Sequences" class="md-nav__link">
      Reference Sequences
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      How-To
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="How-To" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        How-To
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11-1" type="checkbox" id="nav-11-1">
    
    <label class="md-nav__link" for="nav-11-1">
      Connect
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Connect" data-md-level="2">
      <label class="md-nav__title" for="nav-11-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Connect
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/connect/high-memory/" title="High-Memory Nodes" class="md-nav__link">
      High-Memory Nodes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/connect/gpu-nodes/" title="GPU Nodes" class="md-nav__link">
      GPU Nodes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11-2" type="checkbox" id="nav-11-2">
    
    <label class="md-nav__link" for="nav-11-2">
      Software
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Software" data-md-level="2">
      <label class="md-nav__title" for="nav-11-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/openmpi/" title="OpenMPI" class="md-nav__link">
      OpenMPI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/scientific-software/" title="Scientific Software" class="md-nav__link">
      Scientific Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/cell-ranger/" title="Cell Ranger" class="md-nav__link">
      Cell Ranger
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/jupyter/" title="Jupyter" class="md-nav__link">
      Jupyter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/keras/" title="Keras" class="md-nav__link">
      Keras
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/matlab/" title="Matlab" class="md-nav__link">
      Matlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/tensorflow/" title="Tensorflow" class="md-nav__link">
      Tensorflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/software/singularity/" title="Singularity" class="md-nav__link">
      Singularity
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11-3" type="checkbox" id="nav-11-3">
    
    <label class="md-nav__link" for="nav-11-3">
      Service
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Service" data-md-level="2">
      <label class="md-nav__title" for="nav-11-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Service
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/service/file-exchange/" title="File Exchange" class="md-nav__link">
      File Exchange
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11-4" type="checkbox" id="nav-11-4">
    
    <label class="md-nav__link" for="nav-11-4">
      Miscellaneous
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Miscellaneous" data-md-level="2">
      <label class="md-nav__title" for="nav-11-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../how-to/misc/contribute/" title="Contribute to Docs" class="md-nav__link">
      Contribute to Docs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Miscellaneous
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Miscellaneous" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Miscellaneous
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/publication-list/" title="Publication List" class="md-nav__link">
      Publication List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/external-resources/" title="External Guides" class="md-nav__link">
      External Guides
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/tips/" title="Misc. Tips" class="md-nav__link">
      Misc. Tips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/ssh-basics/" title="SSH Basics" class="md-nav__link">
      SSH Basics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/bihealth/bih-cluster/edit/master/bih-cluster/docs/first-steps/episode-3.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="first-steps-episode-3">First Steps: Episode 3<a class="headerlink" href="#first-steps-episode-3" title="Permanent link">&para;</a></h1>
<table>
<thead>
<tr>
<th>Episode</th>
<th>Topic</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><a href="../episode-0/">How can I install the tools?</a></td>
</tr>
<tr>
<td>1</td>
<td><a href="../episode-1/">How can I use the static data?</a></td>
</tr>
<tr>
<td>2</td>
<td><a href="../episode-2/">How can I distribute my jobs on the cluster (Slurm)?</a></td>
</tr>
<tr>
<td><strong>3</strong></td>
<td><strong>How can I organize my jobs with Snakemake?</strong></td>
</tr>
<tr>
<td>4</td>
<td><a href="../episode-4/">How can I combine Snakemake and Slurm?</a></td>
</tr>
</tbody>
</table>
<p>In this episode we will discuss how we can parallelize steps in a pipeline that are not dependent on each other.
In the last episode we saw a case (the variant calling) that could have been potentially parallelized.</p>
<p>We will take care of that today. Please note that we are not going to use the <code>sbatch</code> command we learned
earlier. Thus, this tutorial will run on the same node where you execute the script. We will introduce you to
Snakemake, a tool with which we can model dependencies and run things in parallel. In the next
tutorial we will learn how to submit the jobs with <code>sbatch</code> and Snakemake combined.</p>
<p>For those who know <code>make</code> already, Snakemake will be familiar. You can think of Snakemake being a bunch
of dedicated bash scripts that you can make dependent on each other. Snakemake will start the next
script when a previous one finishes, and potentially it will run things in parallel if the dependencies allow.</p>
<p>Snakemake can get confusing, especially if the project gets big. This tutorial will only cover the very
basics of this powerful tool. For more, we highly recommend digging into the Snakemake documentation:</p>
<ul>
<li><a href="https://snakemake.readthedocs.io/en/stable/">https://snakemake.readthedocs.io/en/stable/</a></li>
<li><a href="http://slides.com/johanneskoester/deck-1#/">http://slides.com/johanneskoester/deck-1#/</a></li>
</ul>
<p>Every Snakemake run requires a <code>Snakefile</code> file. Create a new folder inside your tutorial folder and
copy the skeleton:</p>
<div class="highlight"><pre><span></span><code>(first-steps) $ mkdir -p /fast/users/${USER}/work/tutorial/episode3
(first-steps) $ pushd /fast/users/${USER}/work/tutorial/episode3
(first-steps) $ cp /fast/projects/cubit/work/tutorial/skeletons/Snakefile .
(first-steps) $ chmod u+w Snakefile
</code></pre></div>

<p>Your <code>Snakefile</code> should look as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;snps/test.vcf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;structural_variants/test.vcf&#39;</span>

<span class="n">rule</span> <span class="n">alignment</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;/fast/projects/cubit/work/tutorial/input/test_R1.fq.gz&#39;</span><span class="p">,</span>
        <span class="s1">&#39;/fast/projects/cubit/work/tutorial/input/test_R2.fq.gz&#39;</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">bam</span><span class="o">=</span><span class="s1">&#39;alignment/test.bam&#39;</span><span class="p">,</span>
        <span class="n">bai</span><span class="o">=</span><span class="s1">&#39;alignment/test.bam.bai&#39;</span><span class="p">,</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export TMPDIR=/fast/users/${{USER}}/scratch/tmp</span>
<span class="sd">        mkdir -p ${{TMPDIR}}</span>

<span class="sd">        BWAREF=/fast/projects/cubit/current/static_data/precomputed/BWA/0.7.15/GRCh37/g1k_phase1/human_g1k_v37.fasta</span>

<span class="sd">        bwa mem -t 8 \</span>
<span class="sd">            -R &quot;@RG\tID:FLOWCELL.LANE\tPL:ILLUMINA\tLB:test\tSM:PA01&quot; \</span>
<span class="sd">            ${{BWAREF}} \</span>
<span class="sd">            {input} \</span>
<span class="sd">        | samtools view -b - \</span>
<span class="sd">        | samtools sort -O BAM -T ${{TMPDIR}} -o {output.bam}</span>

<span class="sd">        samtools index {output.bam}</span>
<span class="sd">        &quot;&quot;&quot;</span>

<span class="n">rule</span> <span class="n">structural_variants</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;alignment/test.bam&#39;</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s1">&#39;structural_variants/test.vcf&#39;</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        REF=/fast/projects/cubit/current/static_data/reference/GRCh37/g1k_phase1/human_g1k_v37.fasta</span>

<span class="sd">        delly call -o {output} -g ${{REF}} {input}</span>
<span class="sd">        &quot;&quot;&quot;</span>

<span class="n">rule</span> <span class="n">snps</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;alignment/test.bam&#39;</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s1">&#39;snps/test.vcf&#39;</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        REF=/fast/projects/cubit/current/static_data/reference/GRCh37/g1k_phase1/human_g1k_v37.fasta</span>

<span class="sd">        gatk HaplotypeCaller \</span>
<span class="sd">            -R ${{REF}} \</span>
<span class="sd">            -I {input} \</span>
<span class="sd">            -ploidy 2 \</span>
<span class="sd">            -O {output}</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div>

<p>Let me explain. The content resembles the same steps we took in the previous tutorials.
Although every step has its own rule (alignment, snp calling, structural variant calling), we could
instead have written everything in one rule. It is up to you to design your rules! Note that
the rule names are arbitrary and not mentioned anywhere else in the file.</p>
<p>But there is one primary rule: the <code>rule all</code>. This is the kickoff rule that makes everything run.</p>
<p>As you might have noticed, every rule has three main parameters: <code>input</code>, <code>output</code> and <code>shell</code>.
<code>input</code> defines the files that are going into the rule, <code>output</code> those that are produced
when executing the rule, and <code>shell</code> is the bash script that processes <code>input</code> to produce
<code>output</code>.</p>
<p>Rule <code>all</code> does not have any <code>output</code> or <code>shell</code>, it uses <code>input</code> to start the chain of rules.
Note that the input files of this rule are the output files of rule <code>snps</code> and
<code>structural_variants</code>. The input of those rules is the output of rule <code>alignment</code>. This
is how Snakemake processes the rules: It looks for rule <code>all</code> (or a rule that just has <code>input</code>
files) and figures out how it can create the required input files with other rules by looking at their
<code>output</code> files (the <code>input</code> files of one rule must be the <code>output</code> files of another rule).
In our case it traces the workflow back to rule <code>snps</code> and <code>structural_variants</code> as they
have the matching output files. They depend in return on the alignment,
so the <code>alignment</code> rule must be executed, and this is the first thing that will be done by Snakemake.</p>
<p>There are also some peculiarities about Snakemake:</p>
<ul>
<li>You can name files in <code>input</code> or <code>output</code> as is done in rule <code>alignment</code> with the output files.</li>
<li>You can access the <code>input</code> and <code>output</code> files in the script by writing <code>{input}</code> or <code>{output}</code>.<ul>
<li>If they are not named, they will be concatenated, separated by white space</li>
<li>If they are named, access them with their name, e.g., <code>{output.bam}</code></li>
<li>Curly braces must be escaped with curly braces, e.g., for bash variables: <code>${{VAR}}</code> instead of <code>${VAR}</code> but not Snakemake internal variables like <code>{input}</code> or <code>{output}</code></li>
</ul>
</li>
<li>In the rule <code>structural_variants</code> we cheat a bit because delly does not produce output files if it can't find variants.<ul>
<li>We do this by <code>touching</code> (i.e., creating) the required output file. Snakemake has a function for doing so (call <code>touch()</code> on the filename).</li>
</ul>
</li>
<li>Intermediate folders in the path to output files are always created if they don't exist.</li>
<li>Because Snakemake is Python based, you can write your own functions for it to use, e.g. for creating file names automatically.</li>
</ul>
<p>But Snakemake can do more. It is able to parse the paths of the output files and set wildcards if you want.
For this your input (and output) file names have to follow a parsable scheme. In our case they do!
Our FASTQ files, our only initial input files, start with <code>test</code>. The output of the alignment as well
as the variant calling is also prefixed <code>test</code>. We now can modify the Snakemake file accordingly, by exchanging every
occurrence of <code>test</code> in each <code>input</code> or <code>output</code> field with <code>{id}</code> (note that you could also give a different
name for your variable). Only the input rule should not be touched, otherwise Snakemake would not know
which value this variable should have. Your <code>Snakefile</code> should look now like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;snps/test.vcf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;structural_variants/test.vcf&#39;</span>

<span class="n">rule</span> <span class="n">alignment</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span><span class="n">l</span>
        <span class="s1">&#39;/fast/projects/cubit/work/tutorial/input/</span><span class="si">{id}</span><span class="s1">_R1.fq.gz&#39;</span><span class="p">,</span>
        <span class="s1">&#39;/fast/projects/cubit/work/tutorial/input/</span><span class="si">{id}</span><span class="s1">_R2.fq.gz&#39;</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">bam</span><span class="o">=</span><span class="s1">&#39;alignment/</span><span class="si">{id}</span><span class="s1">.bam&#39;</span><span class="p">,</span>
        <span class="n">bai</span><span class="o">=</span><span class="s1">&#39;alignment/</span><span class="si">{id}</span><span class="s1">.bam.bai&#39;</span><span class="p">,</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        export TMPDIR=/fast/users/${{USER}}/scratch/tmp</span>
<span class="sd">        mkdir -p ${{TMPDIR}}</span>

<span class="sd">        BWAREF=/fast/projects/cubit/current/static_data/precomputed/BWA/0.7.15/GRCh37/g1k_phase1/human_g1k_v37.fasta</span>

<span class="sd">        bwa mem -t 8 \</span>
<span class="sd">            -R &quot;@RG\tID:FLOWCELL.LANE\tPL:ILLUMINA\tLB:test\tSM:PA01&quot; \</span>
<span class="sd">            ${{BWAREF}} \</span>
<span class="sd">            {input} \</span>
<span class="sd">        | samtools view -b - \</span>
<span class="sd">        | samtools sort -O BAM -T ${{TMPDIR}} -o {output.bam}</span>

<span class="sd">        samtools index {output.bam}</span>
<span class="sd">        &quot;&quot;&quot;</span>

<span class="n">rule</span> <span class="n">structural_variants</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;alignment/</span><span class="si">{id}</span><span class="s1">.bam&#39;</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s1">&#39;structural_variants/</span><span class="si">{id}</span><span class="s1">.vcf&#39;</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        REF=/fast/projects/cubit/current/static_data/reference/GRCh37/g1k_phase1/human_g1k_v37.fasta</span>

<span class="sd">        delly call -o {output} -g ${{REF}} {input}</span>
<span class="sd">        &quot;&quot;&quot;</span>

<span class="n">rule</span> <span class="n">snps</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="s1">&#39;alignment/</span><span class="si">{id}</span><span class="s1">.bam&#39;</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="s1">&#39;snps/</span><span class="si">{id}</span><span class="s1">.vcf&#39;</span>
    <span class="n">shell</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        REF=/fast/projects/cubit/current/static_data/reference/GRCh37/g1k_phase1/human_g1k_v37.fasta</span>

<span class="sd">        gatk HaplotypeCaller \</span>
<span class="sd">            -R ${{REF}} \</span>
<span class="sd">            -I {input} \</span>
<span class="sd">            -ploidy 2 \</span>
<span class="sd">            -O {output}</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div>

<p>Before we finally run this, we can make a dry run. Snakemake will show you what it would do:</p>
<div class="highlight"><pre><span></span><code>(first-steps) $ snakemake -n
</code></pre></div>

<p>If everything looks green, you can run it for real. We provide it two cores
to allow two single-threaded jobs to be run simultaneously:</p>
<div class="highlight"><pre><span></span><code>(first-steps) $ snakemake -j 2
</code></pre></div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: May 7, 2020
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../episode-2/" title="Episode 2" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Episode 2
              </div>
            </div>
          </a>
        
        
          <a href="../episode-4/" title="Episode 4" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Episode 4
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2016-2020, BIH HPC IT
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.83fe6e3c.min.js"></script>
      <script src="../../assets/javascripts/bundle.7e1cb91c.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>